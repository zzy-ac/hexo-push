---
title: cloudflare白嫖计划——将部分子域名用cloudflare进行NS解析
date: 2021-04-17 08:35:55
uuid: a745d84e-053d-c1c6-3912-332ba3ca2c22
tags: DNS解析
keywords: 网页
categories: 网页部署
---
cloudflare白嫖计划？

### 首先简单说明一下笔者迫切需要用cloudflare解析部分域名的原因：
> 老白嫖怪，没有自己的服务器，没法自己开ssl,有些资源的调用会很麻烦。</br>Cloudflare免费提供ssl证书，并可以进行强制https。</br>其次就是国外的一些虚拟主机提供商的服务器在国内访问速度不咋地，用cloudflare能稍微快点。

#### 前言
使用过CloudFlare dns功能的都知道需要将您的域名注册商帐户中的当前域名服务器替换为域名的 Cloudflare 域名服务器。域名服务器变更的全局传播最多需要 72 小时。这里就不细述了参考文档
但是国内访问CloudFlare还不如不使用，那么有没有办法将部分服务器本就在国外的子域名用cf来解析，而其他的则用DNSPos来进行解析呢？

#### 初尝试
笔者首先进行了经验主义的第一次尝试：将域名用DNSPos来解析然后用NS记录将部分子域名解析到cf.
这么做貌似是有效的，在修改后的一周内，笔者的这部分子域名成功使用了cf的解析。
但是好景不长，时至今天早晨，cf突然发消息来说笔者的域名的DNS没有用它的，所以把我的解析给停了。（气死！！！）
为此笔者可是好生愁苦。

#### 问题解决
~~可是当笔者起床洗漱完，回房时，突然灵光一闪，既然cf不能随意用NS记录来解析子域名，那干脆把整个域名解析到cf,然后将部分在国内的子域名用NS记录解析到DNSPod不就好了？说干就干。~~

~~ * 第一步~~
~~在域名提供商处将DNS解析改成cloudflare提供的记录值。并等待cf解析激活。~~

~~ * 第二步~~
~~在cf成功激活域名的解析后，添加好在国外的记录值，达到最初的目的——（将部分在国外的子域名用cf解析）~~

~~ * 第三步~~
~~将不需要用cf解析的子域名用NS记录解析到原本的DNSPos上。并继续使用之前的解析记录。~~

4月26日更新
既然上面内容被划了删除线，那么很显然，依然不对劲，跟上一次的效果一样，一个星期后dns缓存反应过来就把咱给ban了。

经过笔者的琢磨发现，原来NS记录压根不是这么用的。
NS可以将子域名交给第三方DNS服务商进行解析，但是提供NS记录的服务商很多，能接收NS记录的子域名的服务商就很少了。
目前在国内可以免费使用的服务商中，经过笔者考证，只有阿里云DNS解析可以提供这样的服务。

于是笔者将DNSPod给扔一边去了，由前文可知笔者已经将域名的DNS解析交给了cloudflare来操作。
然后我们打开阿里云DNS解析的后台<https://dns.console.aliyun.com/>将自己想要解析的子域名添加进来例如你的域名是<code>example.com</code>你要将<code>aaa.example.com</code>单独进行解析，那么你就将aaa.example.com解析到阿里云，然后阿里会给出一个txt记录让你添加到主域名的DNS服务商那里（也就是cloudflare）。添加完成后，阿里云DNS后台这边会显示给你分配了DNS服务器，一般是下列两个。
```
ns1.alidns.com
ns2.alidns.com
```
在cloudflare中添加NS记录，主机记录为aaa,记录类型为NS,记录值为刚刚的两个服务器的地址。

#### 至此，我们就完成了将部分域名使用cloudflare解析，部分使用~~DNSPod~~阿里云DNS解析的目的。
